-- Configuration
local X_SIZE = 6  -- Width (Internal blocks)
local Y_SIZE = 6  -- Height (Internal blocks)
local Z_SIZE = 6  -- Length (Internal blocks)

-- Calculated limits for movement loops
local X_SIZE_MAX_MOVE = X_SIZE - 1 -- 5 steps to traverse 6 blocks
local Z_SIZE_MAX_MOVE = Z_SIZE - 1 -- 5 steps to traverse 6 blocks

-- Define the target and the boundary material
local TARGET_BLOCK = "minecraft:yellow_concrete"
local BOUNDARY_BLOCK = "minecraft:glass"

-- Function to check the block in front and return its name
local function getBlockInFront()
    local success, block = turtle.inspect()
    if success then
        return block.name
    end
    return nil
end

-- Function to check if the target block is found
local function checkForTarget()
    local blockName = getBlockInFront()
    if blockName == TARGET_BLOCK then
        print("Found " .. TARGET_BLOCK .. ". Stopping exploration.")
        return true
    end
    return false
end

-- Function to safely move forward (only if the spot is clear)
local function safeForward()
    local blockName = getBlockInFront()
    
    if blockName == BOUNDARY_BLOCK then
        print("Error: Hit glass boundary. Dimensions may be incorrect.")
        return false 
    end
    
    if blockName then 
        -- Obstruction (not glass/target) found inside the box.
        print("Obstruction (" .. blockName .. ") found. Cannot proceed.")
        return false
    end

    -- Attempt to move forward (only if the spot is empty)
    return turtle.forward()
end

-- Function to turn around 180 degrees
local function turnAround()
    turtle.turnLeft()
    turtle.turnLeft()
end

-- Function to return to the Z=1 row and X=1 column position
local function returnToOrigin(current_z, current_direction)
    print("Returning to the original XZ position...")
    
    -- 1. Turn back to face the Z=1 wall (opposite of the Z sweep direction)
    if current_direction == 1 then
        -- Turtle is facing +X, turn 90 degrees left to face -Z wall
        turtle.turnLeft()
    else
        -- Turtle is facing -X, turn 90 degrees right to face -Z wall
        turtle.turnRight()
    end
    
    -- 2. Move back to the Z=1 row
    for i = 1, current_z - 1 do
        if not safeForward() then return false end
    end
    
    -- 3. Turn to face the X=1 wall (opposite of the X sweep direction)
    turtle.turnLeft()
    
    -- 4. Move back to the X=1 column
    for i = 1, X_SIZE_MAX_MOVE do
        if not safeForward() then return false end
    end
    
    -- 5. Final Turn: Face the original starting direction (+X)
    turtle.turnRight()
    
    return true
end

-- Main Exploration Loop
print("Starting exploration of 6x
